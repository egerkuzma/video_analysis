# Видео-анализатор эмоций в реальном времени

Скрипт для анализа эмоций в реальном времени с IP-камеры через WebSocket соединение. 
Использует FFmpeg для декодирования видеопотока и DeepFace для распознавания эмоций.

## Возможности

- Подключение к IP-камере через WebSocket
- Декодирование видеопотока с помощью FFmpeg
- Анализ эмоций в реальном времени
- Визуализация результатов с наложением текста
- Поддержка русского языка в интерфейсе

## Требования

pip install -r requirements.txt
# requirements.txt

# Основные зависимости
websocket-client>=1.6.4
opencv-python>=4.8.0
numpy>=1.24.0
deepface>=0.0.79

# Дополнительные библиотеки
Pillow>=10.0.0  # для работы с изображениями и шрифтами
tensorflow>=2.13.0  # требуется для DeepFace - надо ставить через wsl если windows
mtcnn>=0.1.1  # для детекции лиц
retina-face>=0.0.13  # альтернативный детектор лиц


Необходимые компоненты:
- Python 3.7+
- FFmpeg
- OpenCV
- DeepFace
- websocket-client
- numpy

## Установка

1. Установите FFmpeg:
   ```bash
   # Для Ubuntu/Debian
   sudo apt-get install ffmpeg

   # Для Windows
   # Скачайте FFmpeg с официального сайта и добавьте в PATH
   ```

2. Установите Python-зависимости:
   ```bash
   pip install websocket-client opencv-python deepface numpy
   ```

## Использование

1. Запустите скрипт:
   ```bash
   python video_analysis.py
   ```

2. Управление:
   - Нажмите 'q' в окне с видео для выхода
   - Ctrl+C в консоли для завершения работы

## Настройка

Основные параметры, которые можно изменить:

python
Размеры кадра
FRAME_WIDTH = 1280
FRAME_HEIGHT = 720
Область анализа (ROI)
LEFT_ROI_X = 240
LEFT_ROI_Y = 130
LEFT_ROI_WIDTH = 250
LEFT_ROI_HEIGHT = 150


## Структура проекта

- `video_analysis.py` - основной скрипт
- `websocket_debug.log` - лог-файл для отладки
- `requirements.txt` - зависимости проекта

## Особенности работы

- Использует FFmpeg для эффективного декодирования видеопотока
- Анализирует только определенную область кадра для повышения производительности
- Поддерживает обработку фрагментированного MP4 через WebSocket
- Многопоточная обработка для плавного воспроизведения

## Решение проблем

1. Если не отображается видео:
   - Проверьте URL камеры
   - Убедитесь, что FFmpeg установлен корректно

2. Если не работает распознавание эмоций:
   - Проверьте освещение
   - Настройте размер ROI

## Лицензия

MIT
